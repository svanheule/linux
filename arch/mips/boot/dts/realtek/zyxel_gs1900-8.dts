// SPDX-License-Identifier: GPL-2.0-or-later
/dts-v1/;

#include "rtl83xx.dtsi"
#include "rtl838x.dtsi"

#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/input/input.h>
#include <dt-bindings/leds/common.h>

#define ZYXEL_PORT_LED(phy) \
	led@##phy##.0 { \
		reg = <##phy 0>; \
		realtek,hardware-managed; \
	}

/ {
	compatible = "zyxel,gs1900-8", "realtek,rtl83xx-soc";
	model = "ZyXEL GS1900-8";

	chosen {
		stdout-path = "serial0";
		bootargs = "earlycon console=ttyS0,115200";
	};

	memory@0 {
		device_type = "memory";
		reg = <0x0 0x8000000>;
	};

	aliases {
		led-boot = &led_sys;
		led-failsafe = &led_sys;
		led-running = &led_sys;
		led-upgrade = &led_sys;
		mdio-gpio1 = &mdio1;
	};

	leds {
		compatible = "gpio-leds";

		pinctrl-names = "default";
		pinctrl-0 = <&sys_led_pins>;

		led_sys: led-0 {
			gpios = <&gpio0 0 GPIO_ACTIVE_HIGH>;
			color = <LED_COLOR_ID_GREEN>;
			function = LED_FUNCTION_STATUS;
			linux,default-trigger = "default-on";
		};
	};

	keys {
		compatible = "gpio-keys-polled";
		poll-interval = <10>;
		debounce-interval = <50>;

		pinctrl-names = "default";
		pinctrl-0 = <&input_pin_cfg>;

		reset {
			gpios = <&gpio1 3 GPIO_ACTIVE_LOW>;
			linux,code = <KEY_RESTART>;
		};
	};

	gpio-restart {
		compatible = "gpio-restart";
		gpios = <&gpio1 5 GPIO_ACTIVE_LOW>;
		priority = <192>;
		open-source;
	};

	mdio1: mdio {
		compatible = "virtual,mdio-gpio";
		#address-cells = <1>;
		#size-cells = <0>;
		gpios = <&gpio0 2 GPIO_ACTIVE_HIGH>,
			<&gpio0 3 GPIO_ACTIVE_HIGH>;

		pinctrl-names = "default";
		pinctrl-0 = <&aux_mdio_pins>;

		reset-gpios = <&gpio0 1 GPIO_ACTIVE_LOW>;
		reset-delay-us = <1000>;
		reset-post-delay-us = <10000>;

		gpio1: expander@0 {
			compatible = "realtek,rtl8231";
			reg = <0x0>;

			gpio-controller;
			#gpio-cells = <2>;
			gpio-ranges = <&gpio1 0 0 37>;

			led-controller {
				compatible = "realtek,rtl8231-leds";
				#address-cells = <2>;
				#size-cells = <0>;
				status = "disabled";
			};

			input_pin_cfg: input-pins {
				gpio_pins {
					pins = "gpio3", "gpio36";
					function = "gpio";
				};
				debounce_test {
					pins = "gpio36";
					input-debounce = <100000>;
				};
			};
		};
	};

	switchcore-bus@1b000000 {
		compatible = "realtek,rtl8380-switchcore", "syscon";
		reg = <0x1b000000 0x10000>;

		led-sys {
			function = "status";
			color = <LED_COLOR_ID_GREEN>;
			linux,default-trigger = "default-on";
		};

		pinctrl {
			compatible = "realtek,rtl8380-pinctrl";

			sys_led_pins: sys-led-mux {
				groups = "sys-led";
				function = "gpio";
			};

			aux_mdio_pins: aux-mdio-mux {
				groups = "aux-mdio";
				function = "gpio";
			};

			uart1_pins: uart1-mux {
				groups = "uart1";
				function = "uart1";
			};
		};

		port-leds {
			compatible = "realtek,rtl8380-port-led";
			#address-cells = <2>;
			#size-cells = <0>;

			realtek,num-led = <1>;

			led@8.0 {
				reg = <8 0>;
				label = "lan1";
			};
			led@9.0 {
				reg = <9 0>;
				label = "lan2";
			};
			led@10.0 {
				reg = <10 0>;
				label = "lan3";
			};
			led@11.0 {
				reg = <11 0>;
				label = "lan4";
			};
			led@12.0 {
				reg = <12 0>;
				label = "lan5";
			};
			led@13.0 {
				reg = <13 0>;
				label = "lan6";
			};
			led@14.0 {
				reg = <14 0>;
				label = "lan7";
			};
			led@15.0 {
				reg = <15 0>;
				label = "lan8";
				linux,default-trigger = "timer";
			};
		};
	};
};

&serial0 {
	status = "okay";
};
