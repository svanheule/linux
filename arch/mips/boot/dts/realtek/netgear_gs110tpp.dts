// SPDX-License-Identifier: GPL-2.0-or-later
/dts-v1/;

#include "rtl83xx.dtsi"
#include "rtl838x.dtsi"

#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/input/input.h>
#include <dt-bindings/leds/common.h>

#define NETGEAR_PORT_LED(phy)			\
	led@##phy##.0 {				\
		reg = <(phy) 0 0>;		\
		color = <LED_COLOR_ID_GREEN>;	\
		function = LED_FUNCTION_LAN;	\
		function-enumerator = <(phy)>;	\
	};					\
	led@##phy##.1 {				\
		reg = <(phy) 1 0>;		\
		color = <LED_COLOR_ID_AMBER>;	\
		function = LED_FUNCTION_LAN;	\
		function-enumerator = <(phy)>;	\
	}

/ {
	compatible = "netgear,gs110tpp-v1", "realtek,rtl83xx-soc";
	model = "Netgear GS110TPP";

	chosen {
		stdout-path = "serial0";
		bootargs = "earlycon console=ttyS0,115200";
	};

	memory@0 {
		device_type = "memory";
		reg = <0x0 0x8000000>;
	};

	aliases {
		mdio-gpio1 = &mdio1;
	};

	keys {
		compatible = "gpio-keys";

		pinctrl-names = "default";
		pinctrl-0 = <&sys_led_pins>;

		reset {
			gpios = <&gpio0 0 GPIO_ACTIVE_LOW>;
			linux,code = <KEY_RESTART>;
		};
	};

	leds {
		pinctrl-names = "default";
		pinctrl-0 = <&led_pin_config>;

		compatible = "gpio-leds";

		led_sys_red: sys_red {
			gpios = <&gpio1 31 GPIO_ACTIVE_LOW>;
			color = <LED_COLOR_ID_RED>;
			function = LED_FUNCTION_STATUS;
		};

		led_sys_green: sys_green {
			gpios = <&gpio1 32 GPIO_ACTIVE_LOW>;
			color = <LED_COLOR_ID_GREEN>;
			function = LED_FUNCTION_STATUS;
		};

		led_sys_blue: sys_blue {
			gpios = <&gpio1 34 GPIO_ACTIVE_LOW>;
			color = <LED_COLOR_ID_BLUE>;
			function = LED_FUNCTION_STATUS;
			linux,default-trigger = "default-on";
		};
	};

	gpio-restart {
		pinctrl-names = "default";
		pinctrl-0 = <&jtag_pins>;

		compatible = "gpio-restart";
		gpios = <&gpio0 13 GPIO_ACTIVE_LOW>;
		priority = <192>;
		open-source;
	};

	mdio1: mdio {
		pinctrl-names = "default";
		pinctrl-0 = <&gpio_mdx_pins>;

		compatible = "virtual,mdio-gpio";
		#address-cells = <1>;
		#size-cells = <0>;
		gpios = <&gpio0 2 GPIO_ACTIVE_HIGH>,
			<&gpio0 3 GPIO_ACTIVE_HIGH>;

		gpio1: gpio-expander@31 {
			compatible = "realtek,rtl8231";
			reg = <31>;

			gpio-controller;
			#gpio-cells = <2>;
			gpio-ranges = <&gpio1 0 0 37>;

			led_pin_config: led-pins {
				pins = "gpio31", "gpio32", "gpio34";
				function = "gpio";
			};
		};
	};

	switchcore-bus@1b000000 {
		compatible = "realtek,rtl8380-switchcore", "syscon";
		reg = <0x1b000000 0x10000>;

		pinctrl {
			compatible = "realtek,rtl8380-pinctrl";

			sys_led_pins: sys-led-mux {
				groups = "sys-led";
				function = "gpio";
			};

			gpio_mdx_pins: aux-mdio-mux {
				groups = "aux-mdio";
				function = "gpio";
			};

			uart1_pins: uart1-mux {
				groups = "uart1";
				function = "uart1";
			};

			jtag_pins: jtag-mux {
				groups = "jtag";
				function = "gpio";
			};
		};

		port-leds {
			compatible = "realtek,rtl8380-port-led";
			#address-cells = <3>;
			#size-cells = <0>;

			realtek,output-mode = "serial";

			NETGEAR_PORT_LED(8);
			NETGEAR_PORT_LED(9);
			NETGEAR_PORT_LED(10);
			NETGEAR_PORT_LED(11);
			NETGEAR_PORT_LED(12);
			NETGEAR_PORT_LED(13);
			NETGEAR_PORT_LED(14);
			NETGEAR_PORT_LED(15);
			NETGEAR_PORT_LED(16);
			NETGEAR_PORT_LED(17);
		};
	};
};

&spi0 {
	flash@0 {
		compatible = "jedec,spi-nor";
		reg = <0>;
		spi-max-frequency = <50000000>;

		partitions {
			compatible = "fixed-partitions";
			#address-cells = <1>;
			#size-cells = <1>;

			partition@0 {
				label = "u-boot";
				reg = <0x0 0xe0000>;
				read-only;
			};
		};
	};
};

&serial0 {
	status = "okay";
};

&serial1 {
	status = "okay";

	pinctrl-names = "default";
	pinctrl-0 = <&uart1_pins>;
};
